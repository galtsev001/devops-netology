## 3.8. Компьютерные сети, лекция 3

#### 1) `ipvs`. Если при запросе на VIP сделать подряд несколько запросов (например, `for i in {1..50}; do curl -I -s 172.28.128.200>/dev/null; done )`, ответы будут получены почти мгновенно. Тем не менее, в выводе ipvsadm -Ln еще некоторое время будут висеть активные InActConn. Почему так происходит?

**Ответ**

`InActConn` - это все состояния соединений кроме ESTABLISHED.

Для LVS типа DR и LVS-Tun директор не видит пакетов от реального сервера к клиенту. А для завершения tcp-соединения происходит отправка FIN с последующим ответом ACK с другого конца. Затем второй участник посылает свой FIN, за которым следует ACK от первой машины.
Однако если реальный сервер инициирует прекращение соединения, директор сможет сделать вывод о том, что это произошло, только увидев ACK от клиента. Директор вынужден делать вывод, что соединение закрыто из частичной информации, и использует свою собственную таблицу тайм-аутов, чтобы объявить, что соединение прервано. Таким образом в колонке InActConn могут быть видны еще некоторое время соединения как активные.